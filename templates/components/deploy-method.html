{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
    <h2 class="mb-4">选择Hadoop集群配置方式</h2>
    <div class="row">
        <!-- 全自动配置 -->
        <div class="col-md-4 mb-4">
            <div class="card h-100">
                <div class="card-body">
                    <h5 class="card-title">全自动配置</h5>
                    <p class="card-text">
                        系统将自动完成所有配置步骤，包括：
                        <ul>
                            <li>自动检测服务器环境</li>
                            <li>自动安装所需组件</li>
                            <li>自动优化配置参数</li>
                        </ul>
                        适合快速部署标准集群。
                    </p>
                </div>
                <div class="card-footer bg-transparent">
                    <button class="btn btn-primary w-100" onclick="selectMethod('auto')">
                        选择全自动配置
                    </button>
                </div>
            </div>
        </div>

        <!-- 半自动配置 -->
        <div class="col-md-4 mb-4">
            <div class="card h-100">
                <div class="card-body">
                    <h5 class="card-title">半自动配置</h5>
                    <p class="card-text">
                        系统将完成基础配置，但允许您：
                        <ul>
                            <li>自定义关键参数</li>
                            <li>选择安装组件</li>
                            <li>调整性能设置</li>
                        </ul>
                        适合有一定经验的用户。
                    </p>
                </div>
                <div class="card-footer bg-transparent">
                    <button class="btn btn-primary w-100" onclick="selectMethod('semi-auto')">
                        选择半自动配置
                    </button>
                </div>
            </div>
        </div>

        <!-- 纯手动配置 -->
        <div class="col-md-4 mb-4">
            <div class="card h-100">
                <div class="card-body">
                    <h5 class="card-title">纯手动配置</h5>
                    <p class="card-text">
                        完全手动配置所有参数：
                        <ul>
                            <li>逐项设置配置参数</li>
                            <li>手动安装组件</li>
                            <li>完全控制每个细节</li>
                        </ul>
                        适合高级用户和特殊需求。
                    </p>
                </div>
                <div class="card-footer bg-transparent">
                    <button class="btn btn-primary w-100" onclick="selectMethod('manual')">
                        选择纯手动配置
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // 检查是否有服务器配置数据
    document.addEventListener('DOMContentLoaded', function() {
        const config = sessionStorage.getItem('serverConfig');
        if (!config) {
            alert('未找到服务器配置信息，请返回重新配置');
            window.location.href = '/';
        }
    });

    function selectMethod(method) {
        // 获取存储的服务器配置
        const config = sessionStorage.getItem('serverConfig');
        
        if (!config) {
            alert('未找到服务器配置信息，请返回重新配置');
            return;
        }

        let route;
        if (method === 'manual') {
            route = '/deploy/manualConfig';
        }
        else if (method === 'semi-auto') {
            route = '/deploy/semiAutoConfig';
        }
        else if (method === 'auto') {
            route = '/deploy/auto';
        }
        
        window.location.href = `${route}?method=${method}&config=${encodeURIComponent(config)}`;
    }
</script>
{% endblock %}